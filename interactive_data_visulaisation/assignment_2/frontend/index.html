<!DOCTYPE html>
<html>
  <head>
    <style>
      html, body {
        padding: 0;
        margin: 0;
        overflow: hidden;
      }
      #map {
        height: 100vh;
        width: 100vw;
      }
      svg {
        background-color: #f1f1f1;
      }
      .country {
        fill: #b8b8b8;
        stroke: #141414;
        stroke-width: .5;
      }
    </style>
  </head>
  <body>
    <div id="container"></div>
    <div id="map"></div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/5.7.0/d3.min.js"></script>
    <script src="http://d3js.org/topojson.v1.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.3.1.min.js"
      integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
      crossorigin="anonymous">
    </script>

    <script>
      (() => {
        // d3.select(window)
        //   .on("resize", sizeChange);
        
        let margin = {
          top: 0,
          left: 0,
          right: 0,
          bottom: 0,
        }
        // let width = 800 - margin.left - margin.right
        // let height = 400 - margin.top - margin.bottom
        let width = window.innerWidth
        let height = window.innerHeight

        let svg = d3.select('#map')
                  .append('svg')
                  // .attr('width', width + margin.left + margin.right)
                  // .attr('height', height + margin.top + margin.bottom)
                  .attr("width", "100%")
                  .attr("height", "100%")
                  .call(d3.zoom().on("zoom", function () {
                    svg.attr("transform", d3.event.transform)
                  }))
                  .append('g')
                  .attr('transform', 'translate(' + margin.left + ',' + margin.top + ')')

        // d3.json("world.topojson")
        let loadMap = d3.json('https://raw.githubusercontent.com/deldersveld/topojson/master/world-countries.json')

        let loadUFOS = d3.csv('ufos.csv')

        Promise.all([loadMap, loadUFOS]).then(function(values) {
          ready(values[0], values[1])
        })


        let projection = d3.geoMercator()
          .translate([width / 2, height / 2])
          .scale(300)
          
        var path = d3.geoPath().projection(projection)


        function ready (mapData, ufoData) {
          var countries = topojson.feature(mapData, mapData.objects.countries1).features
          // var sightings = ufoData

          // console.log(sightings)

          svg.selectAll('.country')
            .data(countries)
            .enter().append('path')
            .attr('class', 'country')
            .attr('d', path)

          // svg.selectAll('.sightings')
          //   .data(sightings)
          //   .enter().append('circle')
          //   .attr('r', 2)
          //   .attr('cx', 10)
          //   .attr('cy', 10)
          //   // .attr('d', path)
        }
      })();
    </script>
  </body>
</html>
